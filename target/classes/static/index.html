<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K8s Resource Monitor - vLLM & SGLang ëª¨ë‹ˆí„°ë§</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            border-left: 5px solid #667eea;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }
        
        .card h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.1em;
        }
        
        .card .value {
            font-size: 2.5em;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        
        .card .subtitle {
            font-size: 0.9em;
            color: #666;
        }
        
        .tabs {
            margin-bottom: 20px;
        }
        
        .tab-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            background: white;
            padding: 10px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .tab-button {
            padding: 15px 25px;
            background: transparent;
            border: 2px solid transparent;
            color: #667eea;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 1em;
        }
        
        .tab-button:hover {
            background: rgba(102, 126, 234, 0.1);
        }
        
        .tab-button.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .table-container {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        th {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            font-weight: 600;
            color: #555;
            position: sticky;
            top: 0;
        }
        
        tbody tr:hover {
            background: rgba(102, 126, 234, 0.05);
        }
        
        .status {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
        }
        
        .status.running, .status.ready {
            background: #d4edda;
            color: #155724;
        }
        
        .status.pending, .status.waiting {
            background: #fff3cd;
            color: #856404;
        }
        
        .status.failed, .status.error {
            background: #f8d7da;
            color: #721c24;
        }
        
        .status.vllm {
            background: #cce5ff;
            color: #004085;
        }
        
        .status.sglang {
            background: #d1ecf1;
            color: #0c5460;
        }
        
        .progress-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .progress-bar {
            width: 100px;
            height: 12px;
            background: #e9ecef;
            border-radius: 6px;
            overflow: hidden;
            position: relative;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745 0%, #28a745 50%, #ffc107 70%, #dc3545 90%);
            transition: width 0.5s ease;
            border-radius: 6px;
        }
        
        .progress-text {
            font-size: 0.9em;
            font-weight: 600;
            min-width: 50px;
        }
        
        .controls {
            position: fixed;
            bottom: 30px;
            right: 30px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .control-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            font-size: 1em;
            font-weight: 600;
            min-width: 120px;
        }
        
        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }
        
        .control-btn.secondary {
            background: #6c757d;
        }
        
        .loading {
            text-align: center;
            padding: 60px;
            color: #666;
            font-size: 1.1em;
        }
        
        .loading::before {
            content: "â³";
            font-size: 2em;
            display: block;
            margin-bottom: 15px;
        }
        
        .error {
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
            color: #721c24;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid #dc3545;
        }
        
        .success {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            color: #155724;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid #28a745;
        }
        
        .filters {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .filter-item {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .filter-item label {
            font-weight: 600;
            color: #555;
            font-size: 0.9em;
        }
        
        .filter-item select, .filter-item input {
            padding: 8px 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 0.9em;
            transition: border-color 0.3s ease;
        }
        
        .filter-item select:focus, .filter-item input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .auto-refresh {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-left: auto;
        }
        
        .toggle-switch {
            position: relative;
            width: 50px;
            height: 25px;
            background: #ccc;
            border-radius: 25px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .toggle-switch.active {
            background: #667eea;
        }
        
        .toggle-switch::before {
            content: '';
            position: absolute;
            width: 21px;
            height: 21px;
            background: white;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: transform 0.3s;
        }
        
        .toggle-switch.active::before {
            transform: translateX(25px);
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .summary-cards {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 15px;
            }
            
            .tab-buttons {
                flex-wrap: wrap;
            }
            
            .controls {
                bottom: 20px;
                right: 20px;
            }
            
            table {
                font-size: 0.9em;
            }
            
            th, td {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ Kubernetes Resource Monitor</h1>
            <p>vLLM & SGLang ëª¨ë¸ ì„œë¹™ ë¦¬ì†ŒìŠ¤ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§</p>
        </div>

        <div class="filters">
            <div class="filter-item">
                <label>ë„¤ì„ìŠ¤í˜ì´ìŠ¤</label>
                <select id="namespace-filter">
                    <option value="">ì „ì²´</option>
                    <option value="default">default</option>
                    <option value="model-serving">model-serving</option>
                    <option value="vllm">vllm</option>
                    <option value="sglang">sglang</option>
                </select>
            </div>
            
            <div class="filter-item">
                <label>ëª¨ë¸ íƒ€ì…</label>
                <select id="model-filter">
                    <option value="">ì „ì²´</option>
                    <option value="vllm">vLLM</option>
                    <option value="sglang">SGLang</option>
                </select>
            </div>
            
            <div class="auto-refresh">
                <label>ìë™ ìƒˆë¡œê³ ì¹¨</label>
                <div class="toggle-switch active" id="auto-refresh-toggle"></div>
                <span id="refresh-status">ON</span>
            </div>
        </div>

        <div id="summary-section" class="summary-cards">
            <!-- Summary cards will be populated by JavaScript -->
        </div>

        <div class="tabs">
            <div class="tab-buttons">
                <button class="tab-button active" onclick="showTab('pods')">ğŸš¢ Pods</button>
                <button class="tab-button" onclick="showTab('nodes')">ğŸ–¥ï¸ Nodes</button>
                <button class="tab-button" onclick="showTab('alerts')">âš ï¸ ì•ŒëŒ</button>
                <button class="tab-button" onclick="showTab('statistics')">ğŸ“Š í†µê³„</button>
            </div>

            <div id="pods-tab" class="tab-content active">
                <div class="table-container">
                    <table id="pods-table">
                        <thead>
                            <tr>
                                <th>Pod ì´ë¦„</th>
                                <th>ë„¤ì„ìŠ¤í˜ì´ìŠ¤</th>
                                <th>ë…¸ë“œ</th>
                                <th>ëª¨ë¸ íƒ€ì…</th>
                                <th>ìƒíƒœ</th>
                                <th>CPU ì‚¬ìš©ë¥ </th>
                                <th>ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ </th>
                                <th>GPU ì‚¬ìš©ë¥ </th>
                                <th>ìƒì„± ì‹œê°„</th>
                            </tr>
                        </thead>
                        <tbody id="pods-tbody">
                            <tr><td colspan="9" class="loading">ë°ì´í„°ë¥¼ ë¡œë”© ì¤‘ì…ë‹ˆë‹¤...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="nodes-tab" class="tab-content">
                <div class="table-container">
                    <table id="nodes-table">
                        <thead>
                            <tr>
                                <th>ë…¸ë“œ ì´ë¦„</th>
                                <th>ì—­í• </th>
                                <th>ìƒíƒœ</th>
                                <th>CPU ì‚¬ìš©ë¥ </th>
                                <th>ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ </th>
                                <th>GPU ì‚¬ìš©ë¥ </th>
                                <th>Pod ê°œìˆ˜</th>
                                <th>OS/ì•„í‚¤í…ì²˜</th>
                            </tr>
                        </thead>
                        <tbody id="nodes-tbody">
                            <tr><td colspan="8" class="loading">ë°ì´í„°ë¥¼ ë¡œë”© ì¤‘ì…ë‹ˆë‹¤...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="alerts-tab" class="tab-content">
                <div id="alerts-container">
                    <div class="loading">ì•ŒëŒ ë°ì´í„°ë¥¼ ë¡œë”© ì¤‘ì…ë‹ˆë‹¤...</div>
                </div>
            </div>

            <div id="statistics-tab" class="tab-content">
                <div id="statistics-container">
                    <div class="loading">í†µê³„ ë°ì´í„°ë¥¼ ë¡œë”© ì¤‘ì…ë‹ˆë‹¤...</div>
                </div>
            </div>
        </div>
    </div>

    <div class="controls">
        <button class="control-btn" onclick="refreshData()">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
        <button class="control-btn secondary" onclick="exportData()">ğŸ“Š ë‚´ë³´ë‚´ê¸°</button>
        <button class="control-btn secondary" onclick="showSettings()">âš™ï¸ ì„¤ì •</button>
    </div>

    <script>
        const API_BASE = '/k8s-monitor/api/v1/resources';
        let currentData = null;
        let autoRefreshInterval = null;
        let isAutoRefreshEnabled = true;

        // Initialize on page load
        window.addEventListener('DOMContentLoaded', function() {
            initializeFilters();
            refreshData();
            startAutoRefresh();
        });

        function initializeFilters() {
            // Filter event listeners
            document.getElementById('namespace-filter').addEventListener('change', applyFilters);
            document.getElementById('model-filter').addEventListener('change', applyFilters);
            
            // Auto refresh toggle
            document.getElementById('auto-refresh-toggle').addEventListener('click', toggleAutoRefresh);
        }

        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
            
            // Load tab-specific data
            if (tabName === 'alerts') {
                loadAlerts();
            } else if (tabName === 'statistics') {
                loadStatistics();
            }
        }

        async function refreshData() {
            try {
                showMessage('ë°ì´í„°ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ëŠ” ì¤‘...', 'info');
                
                const namespace = document.getElementById('namespace-filter').value;
                const url = namespace ? `${API_BASE}/usage?namespace=${namespace}` : `${API_BASE}/usage`;
                
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                currentData = await response.json();
                updateSummary(currentData.clusterSummary);
                updatePodsTable(currentData.pods);
                updateNodesTable(currentData.nodes);
                
                showMessage('ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì™„ë£Œ', 'success');
                setTimeout(() => hideMessage(), 2000);
                
            } catch (error) {
                console.error('Error fetching data:', error);
                showMessage('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');
            }
        }

        function updateSummary(summary) {
            const summarySection = document.getElementById('summary-section');
            summarySection.innerHTML = `
                <div class="card">
                    <h3>ì´ ë…¸ë“œ</h3>
                    <div class="value">${summary.totalNodes || 0}</div>
                    <div class="subtitle">Ready: ${summary.readyNodes || 0}</div>
                </div>
                <div class="card">
                    <h3>ì´ Pod</h3>
                    <div class="value">${summary.totalPods || 0}</div>
                    <div class="subtitle">Running: ${summary.runningPods || 0}</div>
                </div>
                <div class="card">
                    <h3>vLLM Pods</h3>
                    <div class="value">${summary.vllmPods || 0}</div>
                    <div class="subtitle">ëª¨ë¸ ì„œë¹™</div>
                </div>
                <div class="card">
                    <h3>SGLang Pods</h3>
                    <div class="value">${summary.sglangPods || 0}</div>
                    <div class="subtitle">ëª¨ë¸ ì„œë¹™</div>
                </div>
                <div class="card">
                    <h3>í‰ê·  CPU ì‚¬ìš©ë¥ </h3>
                    <div class="value">${(summary.avgCpuUsage || 0).toFixed(1)}%</div>
                    <div class="subtitle">í´ëŸ¬ìŠ¤í„° ì „ì²´</div>
                </div>
                <div class="card">
                    <h3>í‰ê·  ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ </h3>
                    <div class="value">${(summary.avgMemoryUsage || 0).toFixed(1)}%</div>
                    <div class="subtitle">í´ëŸ¬ìŠ¤í„° ì „ì²´</div>
                </div>
                <div class="card">
                    <h3>í‰ê·  GPU ì‚¬ìš©ë¥ </h3>
                    <div class="value">${(summary.avgGpuUsage || 0).toFixed(1)}%</div>
                    <div class="subtitle">í´ëŸ¬ìŠ¤í„° ì „ì²´</div>
                </div>
                <div class="card">
                    <h3>í™œì„± ì•ŒëŒ</h3>
                    <div class="value">${(summary.criticalAlerts || 0) + (summary.warningAlerts || 0)}</div>
                    <div class="subtitle">Critical: ${summary.criticalAlerts || 0}, Warning: ${summary.warningAlerts || 0}</div>
                </div>
            `;
        }

        function updatePodsTable(pods) {
            const tbody = document.getElementById('pods-tbody');
            
            if (!pods || pods.length === 0) {
                tbody.innerHTML = '<tr><td colspan="9" class="loading">Pod ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                return;
            }

            // Apply filters
            const filteredPods = applyPodFilters(pods);

            tbody.innerHTML = filteredPods.map(pod => `
                <tr onclick="showPodDetails('${pod.namespace}', '${pod.name}')">
                    <td>${pod.name}</td>
                    <td>${pod.namespace}</td>
                    <td>${pod.nodeName || 'N/A'}</td>
                    <td><span class="status ${pod.modelType}">${pod.modelType}</span></td>
                    <td><span class="status ${pod.phase.toLowerCase()}">${pod.phase}</span></td>
                    <td>
                        <div class="progress-container">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${pod.cpuUsagePercent || 0}%"></div>
                            </div>
                            <div class="progress-text">${(pod.cpuUsagePercent || 0).toFixed(1)}%</div>
                        </div>
                    </td>
                    <td>
                        <div class="progress-container">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${pod.memoryUsagePercent || 0}%"></div>
                            </div>
                            <div class="progress-text">${(pod.memoryUsagePercent || 0).toFixed(1)}%</div>
                        </div>
                    </td>
                    <td>
                        <div class="progress-container">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${pod.gpuUsagePercent || 0}%"></div>
                            </div>
                            <div class="progress-text">${(pod.gpuUsagePercent || 0).toFixed(1)}%</div>
                        </div>
                    </td>
                    <td>${formatDateTime(pod.creationTime)}</td>
                </tr>
            `).join('');
        }

        function updateNodesTable(nodes) {
            const tbody = document.getElementById('nodes-tbody');
            
            if (!nodes || nodes.length === 0) {
                tbody.innerHTML = '<tr><td colspan="8" class="loading">ë…¸ë“œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                return;
            }

            tbody.innerHTML = nodes.map(node => `
                <tr onclick="showNodeDetails('${node.name}')">
                    <td>${node.name}</td>
                    <td><span class="status ${node.role}">${node.role}</span></td>
                    <td><span class="status ${node.status.toLowerCase()}">${node.status}</span></td>
                    <td>
                        <div class="progress-container">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${node.cpuUsagePercent || 0}%"></div>
                            </div>
                            <div class="progress-text">${(node.cpuUsagePercent || 0).toFixed(1)}%</div>
                        </div>
                    </td>
                    <td>
                        <div class="progress-container">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${node.memoryUsagePercent || 0}%"></div>
                            </div>
                            <div class="progress-text">${(node.memoryUsagePercent || 0).toFixed(1)}%</div>
                        </div>
                    </td>
                    <td>
                        <div class="progress-container">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${node.gpuUsagePercent || 0}%"></div>
                            </div>
                            <div class="progress-text">${(node.gpuUsagePercent || 0).toFixed(1)}%</div>
                        </div>
                    </td>
                    <td>${node.totalPodCount || 0}</td>
                    <td>${node.operatingSystem || 'N/A'}/${node.architecture || 'N/A'}</td>
                </tr>
            `).join('');
        }

        async function loadAlerts() {
            try {
                const response = await fetch(`${API_BASE}/alerts`);
                const alerts = await response.json();
                
                const container = document.getElementById('alerts-container');
                
                if (!alerts || alerts.length === 0) {
                    container.innerHTML = '<div class="success">ğŸ‰ í˜„ì¬ í™œì„±í™”ëœ ì•ŒëŒì´ ì—†ìŠµë‹ˆë‹¤.</div>';
                    return;
                }
                
                container.innerHTML = alerts.map(alert => `
                    <div class="card" style="border-left-color: ${alert.severity === 'CRITICAL' ? '#dc3545' : '#ffc107'}">
                        <h3>${alert.severity === 'CRITICAL' ? 'ğŸš¨' : 'âš ï¸'} ${alert.type}</h3>
                        <p><strong>ë¦¬ì†ŒìŠ¤:</strong> ${alert.resourceType} - ${alert.resourceName}</p>
                        <p><strong>ë„¤ì„ìŠ¤í˜ì´ìŠ¤:</strong> ${alert.namespace || 'N/A'}</p>
                        <p><strong>ë©”ì‹œì§€:</strong> ${alert.message}</p>
                        <p><strong>ì‹œê°„:</strong> ${formatDateTime(alert.timestamp)}</p>
                    </div>
                `).join('');
                
            } catch (error) {
                console.error('Error loading alerts:', error);
                document.getElementById('alerts-container').innerHTML = 
                    '<div class="error">ì•ŒëŒ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>';
            }
        }

        async function loadStatistics() {
            try {
                const response = await fetch(`${API_BASE}/statistics?hours=24`);
                const stats = await response.json();
                
                const container = document.getElementById('statistics-container');
                container.innerHTML = `
                    <div class="summary-cards">
                        <div class="card">
                            <h3>Pod í†µê³„</h3>
                            <div class="value">${stats.podStatistics?.totalPods || 0}</div>
                            <div class="subtitle">ì´ Pod ìˆ˜</div>
                        </div>
                        <div class="card">
                            <h3>í‰ê·  CPU ì‚¬ìš©ë¥ </h3>
                            <div class="value">${(stats.podStatistics?.avgCpuUsage || 0).toFixed(1)}%</div>
                            <div class="subtitle">ì§€ë‚œ 24ì‹œê°„</div>
                        </div>
                        <div class="card">
                            <h3>í‰ê·  ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ </h3>
                            <div class="value">${(stats.podStatistics?.avgMemoryUsage || 0).toFixed(1)}%</div>
                            <div class="subtitle">ì§€ë‚œ 24ì‹œê°„</div>
                        </div>
                        <div class="card">
                            <h3>í‰ê·  GPU ì‚¬ìš©ë¥ </h3>
                            <div class="value">${(stats.podStatistics?.avgGpuUsage || 0).toFixed(1)}%</div>
                            <div class="subtitle">ì§€ë‚œ 24ì‹œê°„</div>
                        </div>
                    </div>
                    
                    <div class="table-container" style="margin-top: 20px;">
                        <h3 style="padding: 20px;">ëª¨ë¸ë³„ í†µê³„</h3>
                        <table>
                            <thead>
                                <tr>
                                    <th>ëª¨ë¸ íƒ€ì…</th>
                                    <th>Pod ìˆ˜</th>
                                    <th>í‰ê·  CPU</th>
                                    <th>í‰ê·  ë©”ëª¨ë¦¬</th>
                                    <th>í‰ê·  GPU</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${Object.entries(stats.modelStatistics || {}).map(([model, data]) => `
                                    <tr>
                                        <td><span class="status ${model}">${model}</span></td>
                                        <td>${data.podCount}</td>
                                        <td>${(data.avgCpuUsage || 0).toFixed(1)}%</td>
                                        <td>${(data.avgMemoryUsage || 0).toFixed(1)}%</td>
                                        <td>${(data.avgGpuUsage || 0).toFixed(1)}%</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
                
            } catch (error) {
                console.error('Error loading statistics:', error);
                document.getElementById('statistics-container').innerHTML = 
                    '<div class="error">í†µê³„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>';
            }
        }

        function applyFilters() {
            if (currentData && currentData.pods) {
                updatePodsTable(currentData.pods);
            }
        }

        function applyPodFilters(pods) {
            const namespaceFilter = document.getElementById('namespace-filter').value;
            const modelFilter = document.getElementById('model-filter').value;
            
            return pods.filter(pod => {
                if (namespaceFilter && pod.namespace !== namespaceFilter) return false;
                if (modelFilter && pod.modelType !== modelFilter) return false;
                return true;
            });
        }

        function toggleAutoRefresh() {
            const toggle = document.getElementById('auto-refresh-toggle');
            const status = document.getElementById('refresh-status');
            
            isAutoRefreshEnabled = !isAutoRefreshEnabled;
            
            if (isAutoRefreshEnabled) {
                toggle.classList.add('active');
                status.textContent = 'ON';
                startAutoRefresh();
            } else {
                toggle.classList.remove('active');
                status.textContent = 'OFF';
                stopAutoRefresh();
            }
        }

        function startAutoRefresh() {
            if (autoRefreshInterval) clearInterval(autoRefreshInterval);
            if (isAutoRefreshEnabled) {
                autoRefreshInterval = setInterval(refreshData, 30000); // 30ì´ˆë§ˆë‹¤
            }
        }

        function stopAutoRefresh() {
            if (autoRefreshInterval) {
                clearInterval(autoRefreshInterval);
                autoRefreshInterval = null;
            }
        }

        function showPodDetails(namespace, podName) {
            // Pod ìƒì„¸ ì •ë³´ë¥¼ ëª¨ë‹¬ì´ë‚˜ ìƒˆ í˜ì´ì§€ë¡œ í‘œì‹œ
            window.open(`${API_BASE}/pods/${namespace}/${podName}`, '_blank');
        }

        function showNodeDetails(nodeName) {
            // Node ìƒì„¸ ì •ë³´ë¥¼ ëª¨ë‹¬ì´ë‚˜ ìƒˆ í˜ì´ì§€ë¡œ í‘œì‹œ
            window.open(`${API_BASE}/nodes/${nodeName}`, '_blank');
        }

        function exportData() {
            if (!currentData) {
                showMessage('ë‚´ë³´ë‚¼ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.', 'error');
                return;
            }
            
            const dataStr = JSON.stringify(currentData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `k8s-resources-${new Date().toISOString().slice(0, 19)}.json`;
            link.click();
            
            URL.revokeObjectURL(url);
            showMessage('ë°ì´í„°ë¥¼ ë‚´ë³´ëƒˆìŠµë‹ˆë‹¤.', 'success');
        }

        function showSettings() {
            // ì„¤ì • ëª¨ë‹¬ í‘œì‹œ (ê°„ë‹¨í•œ êµ¬í˜„)
            alert('ì„¤ì • ê¸°ëŠ¥ì€ í–¥í›„ ì—…ë°ì´íŠ¸ì—ì„œ ì œê³µë©ë‹ˆë‹¤.');
        }

        function showMessage(message, type) {
            const existing = document.querySelector('.message');
            if (existing) existing.remove();
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            messageDiv.textContent = message;
            messageDiv.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                z-index: 1000;
                padding: 15px 25px;
                border-radius: 8px;
                font-weight: 600;
                box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            `;
            
            if (type === 'error') {
                messageDiv.style.background = '#f8d7da';
                messageDiv.style.color = '#721c24';
            } else if (type === 'success') {
                messageDiv.style.background = '#d4edda';
                messageDiv.style.color = '#155724';
            } else {
                messageDiv.style.background = '#d1ecf1';
                messageDiv.style.color = '#0c5460';
            }
            
            document.body.appendChild(messageDiv);
        }

        function hideMessage() {
            const message = document.querySelector('.message');
            if (message) message.remove();
        }

        function formatDateTime(dateTime) {
            if (!dateTime) return 'N/A';
            return new Date(dateTime).toLocaleString('ko-KR');
        }

        // Cleanup on page unload
        window.addEventListener('beforeunload', function() {
            stopAutoRefresh();
        });
    </script>
</body>
</html>